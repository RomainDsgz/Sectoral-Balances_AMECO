# clean environment
rm(list=ls())
# Obtaining and cleaning the data
# Manually download .txt zip from https://ec.europa.eu/info/business-economy-euro/indicators-statistics/economic-databases/macro-economic-database-ameco/download-annual-data-set-macro-economic-database-ameco_en
#
files <- dir("C/Users/rdesg/Documents/Sectoral_Balances/ameco0", ".TXT", full.names = TRUE)
# Load packages
library(dplyr)
library(tidyr)
library(tibble)
# Read files, bind together, clean, save
all_files <- lapply(files, function(file) {
read.table(file, TRUE, ";", fill = TRUE,
stringsAsFactors = FALSE, strip.white = TRUE)
})
unlink(temp_dir, recursive = TRUE)
ameco <- do.call(rbind, all_files)
ameco <- tibble::as_tibble(ameco)
ameco <- ameco[, -ncol(ameco)] #Drop stray/empty last column
names(ameco) <- tolower(names(ameco))
# Extract short country names
ameco$cntry <- regmatches(ameci$code, regexpr("^[[:alnum:]+", ameco$code))
# Convert to long format
ameco <- gather(ameco, key = year, value = value, starts_with("x"))
ameco$year <- gsub("x", "", ameco$year)
ameco$year <- as.numeric(ameco$year)
ameco$value <- suppressWarnings(as.numeric(ameco$value)
save(ameco, file = "C/Users/rdesg/Documents/Sectoral_Balances/ameco.RData",
compress = "xz"))
View(ameco)
# clean environment
rm(list=ls())
source("~/.active-rstudio-document", echo=TRUE)
# Obtaining and cleaning the data
# Manually download .txt zip from https://ec.europa.eu/info/business-economy-euro/indicators-statistics/economic-databases/macro-economic-database-ameco/download-annual-data-set-macro-economic-database-ameco_en
#
files <- dir("C/Users/rdesg/Documents/sectoral_balances/ameco0", ".TXT", full.names = TRUE)
# Load packages
library(dplyr)
library(tidyr)
library(tibble)
# Read files, bind together, clean, save
all_files <- lapply(files, function(file) {
read.table(file, TRUE, ";", fill = TRUE,
stringsAsFactors = FALSE, strip.white = TRUE)
})
unlink(temp_dir, recursive = TRUE)
ameco <- do.call(rbind, all_files)
ameco <- tibble::as_tibble(ameco)
ameco <- ameco[, -ncol(ameco)] #Drop stray/empty last column
names(ameco) <- tolower(names(ameco))
# Extract short country names
ameco$cntry <- regmatches(ameci$code, regexpr("^[[:alnum:]+", ameco$code))
# Convert to long format
ameco <- gather(ameco, key = year, value = value, starts_with("x"))
ameco$year <- gsub("x", "", ameco$year)
ameco$year <- as.numeric(ameco$year)
ameco$value <- suppressWarnings(as.numeric(ameco$value)
save(ameco, file = "C/Users/rdesg/Documents/sectoral_balances/ameco.RData",
compress = "xz"))
# clean environment
rm(list=ls())
# Obtaining and cleaning the data
# Manually download .txt zip from https://ec.europa.eu/info/business-economy-euro/indicators-statistics/economic-databases/macro-economic-database-ameco/download-annual-data-set-macro-economic-database-ameco_en
#
files <- dir("C:/Users/rdesg/Documents/sectoral_balances/ameco0", ".TXT", full.names = TRUE)
# Load packages
library(dplyr)
library(tidyr)
library(tibble)
# Read files, bind together, clean, save
all_files <- lapply(files, function(file) {
read.table(file, TRUE, ";", fill = TRUE,
stringsAsFactors = FALSE, strip.white = TRUE)
})
ameco <- do.call(rbind, all_files)
ameco <- tibble::as_tibble(ameco)
ameco <- ameco[, -ncol(ameco)] #Drop stray/empty last column
names(ameco) <- tolower(names(ameco))
# Extract short country names
ameco$cntry <- regmatches(ameci$code, regexpr("^[[:alnum:]+", ameco$code))
# Convert to long format
ameco <- gather(ameco, key = year, value = value, starts_with("x"))
ameco$year <- gsub("x", "", ameco$year)
ameco$year <- as.numeric(ameco$year)
ameco$value <- suppressWarnings(as.numeric(ameco$value)
save(ameco, file = "C/Users/rdesg/Documents/sectoral_balances/ameco.RData",
compress = "xz"))
save(ameco, file = "C/Users/rdesg/Documents/sectoral_balances/ameco.RData",
compress = "xz")
save(ameco, file = "C:/Users/rdesg/Documents/sectoral_balances/ameco.RData",
compress = "xz")
# Save preparer data
save(ameco, file = "C:/Users/rdesg/Documents/sectoral_balances/ameco.RData",
compress = "xz")
# Load packages for analysis
library(ggplot2)
library(reshape2)
# Extract data for Switzerland (CHE)
ch <- subset(ameco, cntry == "CHE")
# Load data
load("C:/Users/rdesg/Documents/sectoral_balances/ameco.RData")
# Extract data for Switzerland (CHE)
ch <- subset(ameco, cntry == "CHE")
View(ameco)
View(all_files)
View(all_files)
View(all_files)
# Extract data for Switzerland (CHE)
ch <- subset(ameco, country == "Switzerland")
View(ch)
ameco$value <- suppressWarnings(as.numeric(ameco$value))
# Save preparer data
save(ameco, file = "C:/Users/rdesg/Documents/sectoral_balances/ameco.RData",
compress = "xz")
# Load packages for analysis
library(ggplot2)
library(reshape2)
# Load data
load("C:/Users/rdesg/Documents/sectoral_balances/ameco.RData")
# Extract data for Switzerland (CHE)
ch <- subset(ameco, country == "Switzerland")
# clean environment
rm(list=ls())
# Obtaining and cleaning the data
# Manually download .txt zip from https://ec.europa.eu/info/business-economy-euro/indicators-statistics/economic-databases/macro-economic-database-ameco/download-annual-data-set-macro-economic-database-ameco_en
#
files <- dir("C:/Users/rdesg/Documents/sectoral_balances/ameco0", ".TXT", full.names = TRUE)
# Load packages for data extraction
library(dplyr)
library(tidyr)
library(tibble)
# Read files, bind together, clean, save
all_files <- lapply(files, function(file) {
read.table(file, TRUE, ";", fill = TRUE,
stringsAsFactors = FALSE, strip.white = TRUE)
})
ameco <- do.call(rbind, all_files)
ameco <- tibble::as_tibble(ameco)
ameco <- ameco[, -ncol(ameco)] #Drop stray/empty last column
names(ameco) <- tolower(names(ameco))
# Extract short country names
ameco$cntry <- regmatches(ameci$code, regexpr("^[[:alnum:]+", ameco$code))
# Extract short country names
ameco$cntry <- regmatches(ameco$code, regexpr("^[[:alnum:]+", ameco$code))
# Convert to long format
ameco <- gather(ameco, key = year, value = value, starts_with("x"))
ameco$year <- gsub("x", "", ameco$year)
ameco$year <- as.numeric(ameco$year)
ameco$value <- suppressWarnings(as.numeric(ameco$value))
# Save preparer data
save(ameco, file = "C:/Users/rdesg/Documents/sectoral_balances/ameco.RData",
compress = "xz")
# Load packages for analysis
library(ggplot2)
library(reshape2)
# Load data
load("C:/Users/rdesg/Documents/sectoral_balances/ameco.RData")
# Extract data for Switzerland (CHE)
#
ch <- subset(ameco, country == "Switzerland")
# Extract data for Switzerland (CHE)
#
ch <- subset(ameco, country == "Switzerland")
ch
View(ch)
